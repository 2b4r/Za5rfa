<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Ø§Ù„Ù…Ø²Ø®Ø±Ù â€” Ù…ÙˆÙ„Ø¯ Ù†ØµÙˆØµ Ù…Ø²Ø®Ø±ÙØ©</title>
<meta name="description" content="Ø§Ù„Ù…Ø²Ø®Ø±Ù: Ø§ÙƒØªØ¨ Ù†ØµÙƒ ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¹Ø´Ø±Ø§Øª Ø§Ù„Ø£Ø´ÙƒØ§Ù„ ÙˆØ§Ù„Ø®Ø·ÙˆØ· Ø§Ù„Ù…Ø²Ø®Ø±ÙØ© Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù†Ø³Ø® ÙÙˆØ±Ù‹Ø§." />

<style>
  :root{
    --bg0:#070b18;
    --bg1:#0b1227;
    --panel:#0b1326cc;
    --panel2:#0b1326;
    --border:rgba(148,163,184,.22);
    --txt:#e5e7eb;
    --muted:#9aa7bd;

    /* 4 accent colors */
    --c1:#06b6d4; /* cyan */
    --c2:#a78bfa; /* purple */
    --c3:#a3e635; /* lime */
    --c4:#fbbf24; /* amber */

    --shadow: 0 18px 60px rgba(0,0,0,.45);
    --r1:18px;
    --r2:14px;
  }

  *{ box-sizing:border-box }
  html,body{ height:100% }
  body{
    margin:0;
    color:var(--txt);
    font: 15px/1.7 system-ui, "Segoe UI", Arial;
    background:
      radial-gradient(1100px 700px at 10% -10%, rgba(167,139,250,.22), transparent 60%),
      radial-gradient(900px 600px at 95% 10%, rgba(6,182,212,.18), transparent 55%),
      radial-gradient(900px 700px at 30% 120%, rgba(163,230,53,.12), transparent 55%),
      linear-gradient(180deg, var(--bg0), var(--bg1));
    overflow-x:hidden;
  }

  /* subtle pattern */
  .bg-pattern{
    position:fixed; inset:0; pointer-events:none; opacity:.10; mix-blend-mode:screen;
    background-image:
      radial-gradient(circle at 1px 1px, rgba(255,255,255,.35) 1px, transparent 0);
    background-size: 22px 22px;
    mask-image: radial-gradient(circle at 35% 0%, black 0 45%, transparent 70%);
  }

  header{
    position:sticky; top:0; z-index:10;
    backdrop-filter: blur(10px);
    background: linear-gradient(180deg, rgba(7,11,24,.82), rgba(7,11,24,.55));
    border-bottom:1px solid var(--border);
  }

  .wrap{ max-width:1100px; margin:0 auto; padding:14px; }
  .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }

  .brand{
    display:flex; align-items:center; gap:10px;
    font-weight:900; letter-spacing:.3px;
  }
  .logo{
    width:34px; height:34px; border-radius:12px;
    background: radial-gradient(circle at 30% 30%, rgba(6,182,212,.9), rgba(167,139,250,.35), rgba(251,191,36,.15));
    box-shadow: 0 0 0 1px rgba(255,255,255,.08), 0 12px 40px rgba(6,182,212,.15);
    display:grid; place-items:center;
  }
  .logo svg{ filter: drop-shadow(0 0 16px rgba(6,182,212,.35)); }

  .pill{
    font-size:12px;
    padding:5px 10px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.04);
    color: #cfe9ff;
    white-space:nowrap;
  }
  .pill.c1{ border-color: rgba(6,182,212,.35); }
  .pill.c2{ border-color: rgba(167,139,250,.35); }
  .pill.c3{ border-color: rgba(163,230,53,.35); }
  .pill.c4{ border-color: rgba(251,191,36,.35); }

  main{ padding: 10px 0 30px; }

  .grid{
    display:grid;
    grid-template-columns: 1fr;
    gap: 14px;
  }
  @media(min-width:980px){
    .grid{ grid-template-columns: 1fr 1fr; }
  }

  .card{
    background: linear-gradient(180deg, rgba(11,19,38,.75), rgba(11,19,38,.55));
    border:1px solid var(--border);
    border-radius: var(--r1);
    box-shadow: var(--shadow);
    padding: 14px;
    position:relative;
    overflow:hidden;
  }
  .card::before{
    content:"";
    position:absolute; inset:-2px;
    background:
      radial-gradient(500px 220px at 10% 0%, rgba(6,182,212,.18), transparent 70%),
      radial-gradient(500px 220px at 90% 0%, rgba(167,139,250,.18), transparent 70%),
      radial-gradient(560px 260px at 50% 110%, rgba(163,230,53,.10), transparent 70%);
    pointer-events:none;
  }
  .card > *{ position:relative; z-index:1; }

  .muted{ color:var(--muted); }
  .title{
    display:flex; align-items:center; gap:10px;
    margin:0 0 8px 0;
    font-size: 16px;
    font-weight: 800;
  }
  .title small{ font-weight:600; color: var(--muted); }

  textarea, .input, select{
    width:100%;
    background: rgba(9,16,36,.95);
    color: #fff;
    border:1px solid rgba(255,255,255,.11);
    border-radius: var(--r2);
    padding: 10px 12px;
    outline:none;
    transition: .15s ease;
  }
  textarea:focus, .input:focus, select:focus{
    border-color: rgba(6,182,212,.55);
    box-shadow: 0 0 0 4px rgba(6,182,212,.12);
  }

  .btn{
    border: 1px solid rgba(255,255,255,.12);
    background: rgba(20,32,61,.75);
    color: #eaffff;
    border-radius: 12px;
    padding: 9px 12px;
    cursor:pointer;
    transition:.15s ease;
    display:inline-flex; gap:8px; align-items:center;
  }
  .btn:hover{ transform: translateY(-1px); filter:brightness(1.08); }
  .btn:active{ transform: translateY(0px); }
  .btn[disabled]{ opacity:.55; cursor:not-allowed; transform:none; }

  .btn.primary{
    background: linear-gradient(135deg, rgba(6,182,212,.35), rgba(167,139,250,.28));
    border-color: rgba(6,182,212,.35);
  }
  .btn.good{
    background: linear-gradient(135deg, rgba(163,230,53,.25), rgba(6,182,212,.18));
    border-color: rgba(163,230,53,.30);
  }
  .btn.warn{
    background: linear-gradient(135deg, rgba(251,191,36,.22), rgba(167,139,250,.12));
    border-color: rgba(251,191,36,.28);
  }

  .chips{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }
  .chip{
    display:inline-flex; align-items:center; gap:8px;
    border-radius: 999px;
    padding: 6px 10px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.04);
    font-size: 13px;
    color:#d9f6ff;
    cursor:pointer;
    user-select:none;
  }
  .chip input{ accent-color: var(--c1); }

  .hero{
    display:flex; gap:14px; align-items:center; justify-content:space-between;
    padding: 10px 0 2px;
  }
  .hero .left{
    display:flex; flex-direction:column; gap:6px;
  }
  .hero h1{
    margin:0;
    font-size: 20px;
    line-height:1.3;
  }
  .hero p{ margin:0; color: var(--muted); font-size:13px; }
  .hero .art{
    width: 150px; height: 62px; opacity:.95;
    border-radius: 16px;
    border:1px solid rgba(255,255,255,.10);
    background: linear-gradient(135deg, rgba(6,182,212,.18), rgba(167,139,250,.12), rgba(251,191,36,.10));
    display:grid; place-items:center;
  }

  .tabs{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
  .tab{
    padding: 7px 10px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.04);
    color: #cfe9ff;
    cursor:pointer;
    font-size: 13px;
  }
  .tab.active{
    border-color: rgba(6,182,212,.40);
    box-shadow: 0 0 0 4px rgba(6,182,212,.10);
  }

  .list{
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
    max-height: 62vh;
    overflow:auto;
    padding-right: 3px;
  }
  .item{
    border:1px solid rgba(255,255,255,.10);
    border-radius: 14px;
    background: rgba(7,11,24,.55);
    padding: 10px;
  }
  .item .head{
    display:flex; justify-content:space-between; align-items:center; gap:10px;
  }
  .item .name{ font-weight:800; color:#bdefff; }
  .out{
    margin-top:6px;
    white-space:pre-wrap;
    direction:auto;
    font-size: 15px;
  }
  .tools{ display:flex; gap:8px; flex-wrap:wrap; }

  .counter{ display:flex; gap:8px; align-items:center; justify-content:space-between; }

  /* Toast */
  .toast{
    position:fixed;
    bottom: 14px;
    left: 14px;
    z-index: 50;
    display:flex;
    flex-direction:column;
    gap:8px;
    pointer-events:none;
  }
  .toast .t{
    pointer-events:auto;
    min-width: 220px;
    max-width: 320px;
    padding: 10px 12px;
    border-radius: 14px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(7,11,24,.85);
    box-shadow: var(--shadow);
    color:#eaffff;
    display:flex; gap:10px; align-items:flex-start;
    animation: pop .18s ease;
  }
  .t .dot{
    margin-top:4px;
    width:10px; height:10px; border-radius:50%;
    background: var(--c1);
    box-shadow: 0 0 0 4px rgba(6,182,212,.12);
  }
  .t.good .dot{ background: var(--c3); box-shadow: 0 0 0 4px rgba(163,230,53,.12); }
  .t.warn .dot{ background: var(--c4); box-shadow: 0 0 0 4px rgba(251,191,36,.12); }
  @keyframes pop{ from{ transform: translateY(6px); opacity:0 } to{ transform:none; opacity:1 } }

  a{ color:#bdefff; text-decoration:none }
  .tip{ font-size:12px; color:#a9bad1; }
</style>
</head>

<body>
<div class="bg-pattern"></div>

<header>
  <div class="wrap">
    <div class="row" style="justify-content:space-between">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <!-- Inline SVG icon -->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
            <path d="M12 2l1.7 5.2H19l-4.3 3.1L16.4 16 12 12.8 7.6 16l1.7-5.7L5 7.2h5.3L12 2z" stroke="rgba(255,255,255,.85)" stroke-width="1.4" stroke-linejoin="round"/>
          </svg>
        </div>
        <div>
          <div style="font-size:16px">Ø§Ù„Ù…Ø²Ø®Ø±Ù</div>
          <div class="muted" style="font-size:12px;margin-top:-2px">Ù…ÙˆÙ„Ù‘Ø¯ Ø²Ø®Ø§Ø±Ù (Ù†ØµÙˆØµ Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ù†Ø³Ø®)</div>
        </div>
      </div>

      <div class="row">
        <span class="pill c1">Ù†Ø³Ø® ÙÙˆØ±ÙŠ</span>
        <span class="pill c2">Ø¨Ø­Ø«/ÙÙ„ØªØ±Ø©</span>
        <span class="pill c3">Ø¹Ø±Ø¨ÙŠ + Ù„Ø§ØªÙŠÙ†ÙŠ</span>
        <span class="pill c4">Ù…Ù„Ù ÙˆØ§Ø­Ø¯</span>
      </div>
    </div>
  </div>
</header>

<main class="wrap">
  <div class="hero">
    <div class="left">
      <h1>Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµâ€¦ ÙˆØ®ÙØ¯ Ø²Ø®Ø§Ø±Ù Ø¬Ø§Ù‡Ø²Ø© ÙÙˆØ±Ù‹Ø§ âœ¨</h1>
      <p>Ø£ÙØ¶Ù„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø§ØªÙŠÙ†ÙŠØŒ Ù„ÙƒÙ† Ø£Ø¶ÙÙ†Ø§ Ø²Ø®Ø§Ø±Ù Ø¹Ø±Ø¨ÙŠØ© (Ø¥Ø·Ø§Ø±Ø§Øª/ÙÙˆØ§ØµÙ„/Ø®ØªÙ…/ØªØ§Ø¬) + ØªØ·ÙˆÙŠÙ„ ÙˆØªØ´ÙƒÙŠÙ„ Ø®ÙÙŠÙ.</p>
    </div>
    <div class="art" aria-hidden="true">
      <!-- Decorative inline SVG "image" -->
      <svg width="140" height="46" viewBox="0 0 140 46" fill="none">
        <path d="M10 23c18-18 28 18 46 0s28 18 46 0 28 18 28 18" stroke="rgba(229,231,235,.75)" stroke-width="1.4" stroke-linecap="round"/>
        <circle cx="20" cy="23" r="4" fill="rgba(6,182,212,.65)"/>
        <circle cx="70" cy="23" r="4" fill="rgba(167,139,250,.65)"/>
        <circle cx="118" cy="23" r="4" fill="rgba(251,191,36,.55)"/>
        <path d="M70 6l2.1 6.2H79l-5.5 4 2.1 6.8-5.6-4.1-5.6 4.1 2.1-6.8-5.5-4h6.9L70 6z" fill="rgba(163,230,53,.35)"/>
      </svg>
    </div>
  </div>

  <div class="grid" style="margin-top:12px">
    <!-- Left: inputs -->
    <section class="card">
      <div class="title">Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ <small>Ø§ÙƒØªØ¨ Ù‡Ù†Ø§</small></div>

      <label class="muted" for="src">Ø§Ù„Ù†Øµ:</label>
      <textarea id="src" rows="4" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…ÙƒØŒ Ø¬Ù…Ù„Ø©ØŒ Ø£Ùˆ Ø£ÙŠ Ù†Øµ..."></textarea>

      <div class="row" style="margin-top:10px">
        <input id="filter" class="input" placeholder="ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ù†Ù…Ø§Ø· (Ù…Ø«Ø§Ù„: bold, Ø¹Ø±Ø¨ÙŠ, Ø¥Ø·Ø§Ø±, Ø®ØªÙ…, Ø¯ÙˆØ§Ø¦Ø±...)" />
      </div>

      <div class="tabs" role="tablist" aria-label="ÙÙ„ØªØ±Ø© Ø³Ø±ÙŠØ¹Ø©">
        <button class="tab active" data-tab="all">Ø§Ù„ÙƒÙ„</button>
        <button class="tab" data-tab="latin">Ù„Ø§ØªÙŠÙ†ÙŠ</button>
        <button class="tab" data-tab="arabic">Ø¹Ø±Ø¨ÙŠ</button>
        <button class="tab" data-tab="decor">Ø²Ø®Ø±ÙØ©/Ø¥Ø·Ø§Ø±</button>
      </div>

      <div class="row" style="margin-top:10px">
        <button id="btnCopyAll" class="btn primary">ğŸ“‹ Ù†Ø³Ø® ÙƒÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
        <button id="btnShuffle" class="btn good">ğŸ² ØªØ±ØªÙŠØ¨ Ø¹Ø´ÙˆØ§Ø¦ÙŠ</button>
        <button id="btnClear" class="btn warn">ğŸ§¹ Ù…Ø³Ø­</button>
      </div>

      <div class="chips">
        <label class="chip"><input id="optKashida" type="checkbox" /> ØªØ·ÙˆÙŠÙ„ Ø¹Ø±Ø¨ÙŠ (Ù€)</label>
        <label class="chip"><input id="optTashkeel" type="checkbox" /> ØªØ´ÙƒÙŠÙ„ Ø®ÙÙŠÙ</label>
        <label class="chip"><input id="optDecor1" type="checkbox" /> Ø²Ø®Ø±ÙØ© â€¢âœ§â€¢</label>
        <label class="chip"><input id="optDecor2" type="checkbox" /> Ø²Ø®Ø±ÙØ© âŒ¯âŸ¡âŒ¯</label>
        <label class="chip"><input id="optFrame" type="checkbox" /> Ø¥Ø·Ø§Ø± Ø¹Ø±Ø¨ÙŠ âŸª âŸ«</label>
        <label class="chip"><input id="optCrown" type="checkbox" /> ØªØ§Ø¬ ğŸ‘‘</label>
        <label class="chip"><input id="optSeal" type="checkbox" /> Ø®ØªÙ… ğŸª¬</label>
      </div>

      <div class="tip" style="margin-top:10px">
        ğŸ’¡ Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¨Ø¹Ø¶ Ø§Ù„Ø²Ø®Ø§Ø±Ù (Fraktur/Scriptâ€¦) Ù‚Ø¯ Ù„Ø§ ØªØ¸Ù‡Ø± Ø¹Ù„Ù‰ Ø¨Ø¹Ø¶ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©. Ù„Ù„Ø¹Ø±Ø¨ÙŠ: Ø§Ù„Ø¥Ø·Ø§Ø±/Ø§Ù„Ø®ØªÙ…/Ø§Ù„ØªØ§Ø¬ Ø£ÙƒØ«Ø± Ø«Ø¨Ø§ØªÙ‹Ø§ Ù…Ù† â€œØ­Ø±ÙˆÙ Ù…Ø²Ø®Ø±ÙØ©â€.
      </div>
    </section>

    <!-- Right: results -->
    <section class="card">
      <div class="counter">
        <div class="title" style="margin:0">Ø§Ù„Ù†ØªØ§Ø¦Ø¬ <small>Ø§Ù†Ø³Ø® Ø¨Ø¶ØºØ·Ø©</small></div>
        <span id="count" class="pill">â€” Ù†ØªÙŠØ¬Ø©</span>
      </div>
      <div id="list" class="list" aria-live="polite"></div>
    </section>
  </div>

  <section class="card" style="margin-top:14px">
    <div class="title">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø³Ø±ÙŠØ¹Ø© <small>Ù…Ø®ØªØµØ± Ù…ÙÙŠØ¯</small></div>
    <ul style="margin:6px 0 0 0; padding-left:18px">
      <li>ÙƒÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ <b>Ù†Øµ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ù†Ø³Ø®</b> (Ù…Ø´ ØµÙˆØ±).</li>
      <li>Ø§Ù„Ø²Ø®Ø±ÙØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ù‡Ù†Ø§ â€œØ­Ù„ÙŠØ§Øª/Ø¥Ø·Ø§Ø±Ø§Øª/ÙÙˆØ§ØµÙ„â€ Ø¹Ø´Ø§Ù† Ø§Ù„Ø¹Ø±Ø¨ÙŠ Ù…Ø§Ø¹Ù†Ø¯ÙˆØ´ Unicode fancy fonts Ø²ÙŠ Ø§Ù„Ù„Ø§ØªÙŠÙ†ÙŠ Ø¨Ø´ÙƒÙ„ Ù…Ø¶Ù…ÙˆÙ† Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©.</li>
      <li>Ù„Ùˆ Ø¹Ø§ÙŠØ² Ø£Ø³Ù…Ø§Ø¡ Ø£Ù‚Ø³Ø§Ù…/Ø«ÙŠÙ…Ø§Øªâ€¦ Ø§Ø¨Ø¹ØªÙ„ÙŠ Ù…Ø«Ø§Ù„ ÙˆØ£Ù†Ø§ Ø£Ø¶ÙŠÙ Ø³ØªØ§ÙŠÙ„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¨Ù†ÙØ³ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨.</li>
    </ul>
  </section>
</main>

<div class="toast" id="toast"></div>

<script>
/* ========= Helpers ========= */
const $ = sel => document.querySelector(sel);
const src = $('#src'), list = $('#list'), countEl = $('#count'), filterEl = $('#filter');
const optK = $('#optKashida'), optT = $('#optTashkeel'), optD1 = $('#optDecor1'), optD2 = $('#optDecor2');
const optFrame = $('#optFrame'), optCrown = $('#optCrown'), optSeal = $('#optSeal');

const toastWrap = $('#toast');
function toast(msg, type='info'){
  const el = document.createElement('div');
  el.className = 't ' + (type==='good'?'good':type==='warn'?'warn':'');
  el.innerHTML = `<div class="dot"></div><div style="font-size:13px;line-height:1.5">${escapeHtml(msg)}</div>`;
  toastWrap.appendChild(el);
  setTimeout(()=>{ el.style.opacity='0'; el.style.transform='translateY(6px)'; }, 1800);
  setTimeout(()=>{ el.remove(); }, 2200);
}

const AR_LET = /[\u0621-\u064A]/;
function isArabicChar(ch){ return AR_LET.test(ch); }

/* ========= Unicode Maps (Latin) ========= */
const base = {
  u: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
  l: 'abcdefghijklmnopqrstuvwxyz',
  d: '0123456789'
};

function mapByOffset(txt, offU, offL, offD){
  let out = '';
  for (const ch of txt){
    const iu = base.u.indexOf(ch), il = base.l.indexOf(ch), id = base.d.indexOf(ch);
    if (iu>-1 && offU!=null) out += String.fromCodePoint(ch.codePointAt(0) - 0x41 + offU);
    else if (il>-1 && offL!=null) out += String.fromCodePoint(ch.codePointAt(0) - 0x61 + offL);
    else if (id>-1 && offD!=null) out += String.fromCodePoint(ch.codePointAt(0) - 0x30 + offD);
    else out += ch;
  }
  return out;
}

const OV_FRK = { 'C':'\u212D','H':'\u210C','I':'\u2111','R':'\u211C','Z':'\u2128' };
const OV_SCR = { 'B':'\u212C','E':'\u2130','F':'\u2131','H':'\u210B','I':'\u2110','L':'\u2112','M':'\u2133','R':'\u211B' };

function mapScript(txt){
  let out='';
  for (const ch of txt){
    const iu = base.u.indexOf(ch), il = base.l.indexOf(ch);
    if (iu>-1) out += OV_SCR[ch] || String.fromCodePoint(0x1D49C + iu);
    else if (il>-1) out += String.fromCodePoint(0x1D4B6 + il);
    else out += ch;
  }
  return out;
}
function mapFraktur(txt){
  let out='';
  for (const ch of txt){
    const iu = base.u.indexOf(ch), il = base.l.indexOf(ch);
    if (iu>-1) out += OV_FRK[ch] || String.fromCodePoint(0x1D504 + iu);
    else if (il>-1) out += String.fromCodePoint(0x1D51E + il);
    else out += ch;
  }
  return out;
}
function mapCircled(txt){
  let out='';
  for (const ch of txt){
    const iu=base.u.indexOf(ch), il=base.l.indexOf(ch), id=base.d.indexOf(ch);
    if (iu>-1) out += String.fromCodePoint(0x24B6 + iu);
    else if (il>-1) out += String.fromCodePoint(0x24D0 + il);
    else if (id>-1){
      if (ch==='0') out += '\u24EA';
      else out += String.fromCodePoint(0x2460 + (id-1));
    } else out += ch;
  }
  return out;
}

const SUP = {
  a:'áµƒ',b:'áµ‡',c:'á¶œ',d:'áµˆ',e:'áµ‰',f:'á¶ ',g:'áµ',h:'Ê°',i:'á¶¦',j:'Ê²',k:'áµ',l:'Ë¡',m:'áµ',n:'â¿',o:'áµ’',p:'áµ–',q:'á‘«',r:'Ê³',s:'Ë¢',t:'áµ—',u:'áµ˜',v:'áµ›',w:'Ê·',x:'Ë£',y:'Ê¸',z:'á¶»',
  A:'á´¬',B:'á´®',D:'á´°',E:'á´±',G:'á´³',H:'á´´',I:'á´µ',J:'á´¶',K:'á´·',L:'á´¸',M:'á´¹',N:'á´º',O:'á´¼',P:'á´¾',R:'á´¿',T:'áµ€',U:'áµ',V:'â±½',W:'áµ‚',
  '0':'â°','1':'Â¹','2':'Â²','3':'Â³','4':'â´','5':'âµ','6':'â¶','7':'â·','8':'â¸','9':'â¹'
};
function mapSup(txt){ return [...txt].map(ch=>SUP[ch]||ch).join(''); }

const SC = {'a':'á´€','b':'Ê™','c':'á´„','d':'á´…','e':'á´‡','f':'êœ°','g':'É¢','h':'Êœ','i':'Éª','j':'á´Š','k':'á´‹','l':'ÊŸ','m':'á´','n':'É´','o':'á´','p':'á´˜','q':'Ç«','r':'Ê€','s':'s','t':'á´›','u':'á´œ','v':'á´ ','w':'á´¡','x':'x','y':'Ê','z':'á´¢'};
function mapSmallCaps(txt){ return [...txt].map(ch=>SC[ch]||SC[ch?.toLowerCase()]||ch).join(''); }

const UP = {'a':'É','b':'q','c':'É”','d':'p','e':'Ç','f':'ÉŸ','g':'Æƒ','h':'É¥','i':'á´‰','j':'É¾','k':'Ê','l':'×Ÿ','m':'É¯','n':'u','o':'o','p':'d','q':'b','r':'É¹','s':'s','t':'Ê‡','u':'n','v':'ÊŒ','w':'Ê','x':'x','y':'Ê','z':'z',
'A':'âˆ€','B':'ê“­','C':'Æ†','D':'â—–','E':'Æ','F':'â„²','G':'â…','H':'H','I':'I','J':'Å¿','K':'Ê','L':'Ë¥','M':'W','N':'N','O':'O','P':'Ô€','Q':'ÎŒ','R':'á´š','S':'S','T':'âŠ¥','U':'âˆ©','V':'Î›','W':'M','X':'X','Y':'â…„','Z':'Z',
'0':'0','1':'Æ–','2':'á„…','3':'Æ','4':'ã„£','5':'Ï›','6':'9','7':'ã„¥','8':'8','9':'6'};
function mapUpside(txt){ return [...txt].reverse().map(ch=>UP[ch]||ch).join(''); }

/* ========= Arabic helpers ========= */
function applyKashida(s){
  const chars = [...s];
  let out = '';
  for (let i=0;i<chars.length;i++){
    out += chars[i];
    if (AR_LET.test(chars[i]) && AR_LET.test(chars[i+1]||'')) out += '\u0640';
  }
  return out;
}
function applyTashkeelLight(s){
  const diacs = ['\u064E','\u064F','\u0650','\u0652']; // ÙØªØ­Ø©ØŒ Ø¶Ù…Ø©ØŒ ÙƒØ³Ø±Ø©ØŒ Ø³ÙƒÙˆÙ†
  let out='', n=0;
  for (const ch of s){
    out += ch;
    if (AR_LET.test(ch) && (++n%2===0)) out += diacs[n%diacs.length];
  }
  return out;
}

/* Arabic decorations (safe + visible) */
function arabicFrame(s){
  // Ornate Arabic-ish frame using safe glyphs
  const top = 'â”â”â”â”â–â”â”â”â”“';
  const bot = 'â”—â”â”â”â–â”â”â”â”›';
  return `${top}\n${s}\n${bot}`;
}
function arabicRibbon(s){
  // Banner-like
  return `â ${s} â`;
}
function arabicSeal(s){
  // stamp
  return `ğŸª„ã€ ${s} ã€‘ğŸª„`;
}
function arabicCrown(s){
  return `ğŸ‘‘ ${s} ğŸ‘‘`;
}
function arabicRosette(s){
  // rosettes + separators
  return `à¼ºâœ¦ ${s} âœ¦à¼»`;
}
function arabicDots(s){
  return `â€¢ â”€â”€â”€ ${s} â”€â”€â”€ â€¢`;
}
function decorate(s,mode){
  if(!s.trim()) return s;
  if(mode===1) return `â€¢âœ§ ${s} âœ§â€¢`;
  if(mode===2) return `âŒ¯âŸ¡ ${s} âŸ¡âŒ¯`;
  return s;
}

/* ========= Styles ========= */
const STYLES = [
  // meta categories: latin/arabic/decor
  {id:'plain',    cat:'all',    name:'Ø¹Ø§Ø¯ÙŠ (Ø¨Ø¯ÙˆÙ† ØªØºÙŠÙŠØ±)', fn:(t)=>t},

  // Latin
  {id:'bold',     cat:'latin',  name:'Bold â€” Ø³Ù…ÙŠÙƒ',          fn:(t)=>mapByOffset(t,0x1D400,0x1D41A,0x1D7CE)},
  {id:'italic',   cat:'latin',  name:'Italic â€” Ù…Ø§Ø¦Ù„',        fn:(t)=>mapByOffset(t,0x1D434,0x1D44E,null)},
  {id:'boldit',   cat:'latin',  name:'Bold Italic â€” Ø³Ù…ÙŠÙƒ Ù…Ø§Ø¦Ù„',fn:(t)=>mapByOffset(t,0x1D468,0x1D482,null)},
  {id:'sansb',    cat:'latin',  name:'Sans Bold â€” Ø¹Ø±ÙŠØ¶',     fn:(t)=>mapByOffset(t,0x1D5D4,0x1D5EE,0x1D7EC)},
  {id:'mono',     cat:'latin',  name:'Monospace â€” Ø«Ø§Ø¨Øª',      fn:(t)=>mapByOffset(t,0x1D670,0x1D68A,0x1D7F6)},
  {id:'script',   cat:'latin',  name:'Script â€” Ù…Ø²Ø®Ø±Ù',       fn:mapScript},
  {id:'frak',     cat:'latin',  name:'Fraktur â€” Ø²Ø®Ø±ÙØ© Ù‚Ø¯ÙŠÙ…Ø©', fn:mapFraktur},
  {id:'ds',       cat:'latin',  name:'Double-Struck â€” Ø±ÙŠØ§Ø¶ÙŠ', fn:(t)=>mapByOffset(t,0x1D538,0x1D552,0x1D7D8)},
  {id:'circ',     cat:'latin',  name:'Circled â€” Ø¯Ø§Ø®Ù„ Ø¯ÙˆØ§Ø¦Ø±',   fn:mapCircled},
  {id:'sup',      cat:'latin',  name:'Superscript â€” ØµØºÙŠØ±',     fn:mapSup},
  {id:'sc',       cat:'latin',  name:'Small-Caps â€” ÙƒØ§Ø¨ÙŠØªØ§Ù„ ØµØºÙŠØ±', fn:mapSmallCaps},
  {id:'flip',     cat:'latin',  name:'Upside-Down â€” Ù…Ù‚Ù„ÙˆØ¨',    fn:mapUpside},

  // Arabic transforms
  {id:'kashida',  cat:'arabic', name:'Ø¹Ø±Ø¨ÙŠ â€” ØªØ·ÙˆÙŠÙ„ (Ù€)',        fn:applyKashida},
  {id:'tashkeel', cat:'arabic', name:'Ø¹Ø±Ø¨ÙŠ â€” ØªØ´ÙƒÙŠÙ„ Ø®ÙÙŠÙ',       fn:applyTashkeelLight},

  // Arabic decorations (frames/seals)
  {id:'kashida',  cat:'arabic', name:'Ø¹Ø±Ø¨ÙŠ â€” ØªØ·ÙˆÙŠÙ„ (Ù€)',        fn:applyKashida},
  {id:'tashkeel', cat:'arabic', name:'Ø¹Ø±Ø¨ÙŠ â€” ØªØ´ÙƒÙŠÙ„ Ø®ÙÙŠÙ',       fn:applyTashkeelLight},

  // Arabic decorations (frames/seals)
  {id:'ar_ribbon',cat:'decor',  name:'Ø²Ø®Ø±ÙØ© Ø¹Ø±Ø¨ÙŠØ© â€” Ø£Ù‚ÙˆØ§Ø³ â â', fn:arabicRibbon},
  {id:'ar_rosette',cat:'decor', name:'Ø²Ø®Ø±ÙØ© Ø¹Ø±Ø¨ÙŠØ© â€” ÙˆØ±Ø¯Ø© à¼ºâœ¦à¼»',  fn:arabicRosette},
  {id:'ar_dots',  cat:'decor',  name:'Ø²Ø®Ø±ÙØ© Ø¹Ø±Ø¨ÙŠØ© â€” ÙÙˆØ§ØµÙ„ â€¢â”€â”€â€¢', fn:arabicDots},
  {id:'ar_seal',  cat:'decor',  name:'Ø²Ø®Ø±ÙØ© Ø¹Ø±Ø¨ÙŠØ© â€” Ø®ØªÙ… ğŸª¬',     fn:arabicSeal},
  {id:'ar_crown', cat:'decor',  name:'Ø²Ø®Ø±ÙØ© Ø¹Ø±Ø¨ÙŠØ© â€” ØªØ§Ø¬ ğŸ‘‘',      fn:arabicCrown},
  {id:'ar_frame', cat:'decor',  name:'Ø²Ø®Ø±ÙØ© Ø¹Ø±Ø¨ÙŠØ© â€” Ø¥Ø·Ø§Ø±',       fn:arabicFrame},
];

let activeTab = 'all';

/* ========= Render ========= */
function genAll(){
  const raw = src.value || '';
  const q = (filterEl.value||'').trim().toLowerCase();

  const mods = {
    k: optK.checked,
    t: optT.checked,
    d1: optD1.checked,
    d2: optD2.checked,
    frame: optFrame.checked,
    crown: optCrown.checked,
    seal: optSeal.checked,
  };

  const results = [];
  for (const st of STYLES){
    // tab filter
    if (activeTab !== 'all'){
      if (activeTab === 'latin' && st.cat !== 'latin') continue;
      if (activeTab === 'arabic' && st.cat !== 'arabic') continue;
      if (activeTab === 'decor' && st.cat !== 'decor') continue;
    }

    // text filter
    if (q && !(`${st.id} ${st.name} ${st.cat}`.toLowerCase().includes(q))) continue;

    let out = st.fn(raw);

    // optional global Arabic-ish mods (apply to all outputs)
    if (mods.k && st.id!=='kashida') out = applyKashida(out);
    if (mods.t && st.id!=='tashkeel') out = applyTashkeelLight(out);

    // extra decorations checkboxes
    if (mods.d1) out = decorate(out,1);
    if (mods.d2) out = decorate(out,2);
    if (mods.frame) out = arabicFrame(out);
    if (mods.crown) out = arabicCrown(out);
    if (mods.seal) out = arabicSeal(out);

    results.push({id:st.id, name:st.name, text:out});
  }

  list.innerHTML = results.map((r, idx)=>`
    <div class="item">
      <div class="head">
        <div class="name">${escapeHtml(r.name)}</div>
        <div class="tools">
          <button class="btn" data-i="${idx}">Ù†Ø³Ø®</button>
        </div>
      </div>
      <div class="out">${escapeHtml(r.text) || '<span class="muted">â€”</span>'}</div>
    </div>
  `).join('');

  // bind copy (store texts in closure instead of data attribute)
  const buttons = list.querySelectorAll('button[data-i]');
  buttons.forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const i = Number(btn.getAttribute('data-i'));
      const txt = results[i]?.text ?? '';
      copyText(txt);
      toast('ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…', 'good');
    });
  });

  countEl.textContent = results.length + ' Ù†ØªÙŠØ¬Ø©';
}

function copyText(s){
  if (navigator.clipboard?.writeText) navigator.clipboard.writeText(s);
  else {
    const t=document.createElement('textarea');
    t.value=s;
    t.style.position='fixed';
    t.style.opacity='0';
    document.body.appendChild(t);
    t.select();
    document.execCommand('copy');
    t.remove();
  }
}

/* Fix: escape/decode */
function escapeHtml(s){
  return String(s).replace(/[&<>"']/g, m=>({
    '&':'&amp;',
    '<':'&lt;',
    '>':'&gt;',
    '"':'&quot;',
    "'":'&#39;'
  }[m]));
}

/* ========= Events ========= */
['input','change'].forEach(ev=>{
  src.addEventListener(ev, genAll);
  filterEl.addEventListener(ev, genAll);
  optK.addEventListener(ev, genAll);
  optT.addEventListener(ev, genAll);
  optD1.addEventListener(ev, genAll);
  optD2.addEventListener(ev, genAll);
  optFrame.addEventListener(ev, genAll);
  optCrown.addEventListener(ev, genAll);
  optSeal.addEventListener(ev, genAll);
});

document.getElementById('btnCopyAll').onclick = ()=>{
  const texts = [...list.querySelectorAll('.out')].map(d=>d.textContent).join('\n');
  if (!texts.trim()){
    toast('Ù…ÙÙŠØ´ Ø­Ø§Ø¬Ø© ØªØªÙ†Ø³Ø®â€¦ Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø£ÙˆÙ„ ğŸ™‚', 'warn');
    return;
  }
  copyText(texts);
  toast('ØªÙ… Ù†Ø³Ø® ÙƒÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ğŸ“‹', 'good');
};

document.getElementById('btnClear').onclick = ()=>{
  src.value='';
  genAll();
  toast('Ø§ØªÙ…Ø³Ø­ âœ…', 'good');
};

document.getElementById('btnShuffle').onclick = ()=>{
  const items = [...STYLES];
  // Fisher-Yates
  for (let i=items.length-1;i>0;i--){
    const j = Math.floor(Math.random()*(i+1));
    [items[i],items[j]]=[items[j],items[i]];
  }
  // keep plain first always (better UX)
  const plain = items.find(x=>x.id==='plain');
  const rest = items.filter(x=>x.id!=='plain');
  STYLES.length=0;
  STYLES.push(plain, ...rest);
  genAll();
  toast('ØªÙ… ØªØºÙŠÙŠØ± ØªØ±ØªÙŠØ¨ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ğŸ²', 'good');
};

/* Tabs */
document.querySelectorAll('.tab').forEach(t=>{
  t.addEventListener('click', ()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    t.classList.add('active');
    activeTab = t.getAttribute('data-tab') || 'all';
    genAll();
  });
});

/* Autosave */
const KEY='mazakhref_input_v2_singlefile';
src.value = localStorage.getItem(KEY) || '';
src.addEventListener('input', ()=>localStorage.setItem(KEY, src.value));

/* initial */
genAll();
</script>
</body>
</html>
